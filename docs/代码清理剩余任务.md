# 代码清理剩余任务

> 本文档汇总当前代码库中仍待处理的清理项，并给出推荐的执行步骤。完成每一步后请执行 `pio run` 进行编译验证。

---

## 1. BatteryManager 模块（可选）

若硬件 **无电池/充电线路**，可移除 BatteryManager：

1. 删除文件 `src/BatteryManager.h`、`src/BatteryManager.cpp`。
2. 删除所有源码中的 `#include "BatteryManager.h"` 以及 `batteryManager` 相关调用。
3. 移除宏 `ENABLE_BATTERY_MANAGER` 及其条件编译分支，并从 `config.h` 中删除该宏。
4. 重新编译，确认无引用错误。

如后续仍可能加入电池功能，可暂时跳过本节。

---

## 2. 零散清理

1. **TODO / 过期注释**  
   - `src/FeedbackManager.cpp`：第 347、353、366、371 行  
   - `src/KeypadControl.cpp`：第 319 行  
   - 其余通过 `grep -n "TODO" src include` 搜索  
   - 若对应功能已完成，删除注释；否则登记到 issue tracker。

2. **重复或无效宏**  
   - 检查 `config.h` 中 LCD、LED 引脚及功能宏，删除重复或无效定义。  
   - 确保硬件映射仅在单处维护，避免歧义。

3. **临时文件**  
   - 仓库根目录及 `src/`、`include/` 均存在 `.DS_Store`，请加入 `.gitignore` 并删除。

---

## 3. 文档同步

- 更新 `README`、`CLAUDE.md` 中的模块说明，删除已移除组件。  
- 若移除了 BatteryManager，请补充供电说明。

---

## 4. 编译 & 体积监控

- 每次删除/修改后运行 `pio run`，记录固件体积变化。  
- 可在 CI（GitHub Actions 等）启用 size-check 插件，追踪 PR 的二进制大小差异。

---

> 完成以上所有任务并验证通过后，可删除本文件并提交最终 PR。 